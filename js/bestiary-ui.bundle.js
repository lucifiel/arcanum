"use strict";(self.webpackChunk_name_=self.webpackChunk_name_||[]).push([[215],{1430:(t,e,n)=>{n.d(e,{Z:()=>l});var s=n(4015),r=n.n(s),i=n(3645),a=n.n(i)()(r());a.push([t.id,"\nlabel[data-v-6d0e0bec] {\n\tmargin-right:var(--md-gap);\n}\n","",{version:3,sources:["webpack://./src/ui/components/filterbox.vue"],names:[],mappings:";AAqEA;CACA,0BAAA;AACA",sourcesContent:["<script>\nexport default {\n\n\t/**\n\t * @property {object[]} items - items to filter.\n\t * @property {prop} [prop='name'] - target prop of filter test.\n\t *\n\t * @property {number} [minItems=0] - minimum number of items before box is visible.\n\t */\n\tprops:['value', 'items', 'prop', 'minItems'],\n\tdata() {\n\t\treturn {\n\t\t\ttext:'',\n\t\t\tpprop:this.prop||'name'\n\t\t}\n\t},\n\twatch:{\n\t\titems(newVal,oldVal){ this.findText = this.findText; }\n\t},\n\tcreated(){\n\t\tthis.findText = this.text;\n\t},\n\tmethods:{\n\t\tclear(){ this.text = ''; }\n\t},\n\tcomputed:{\n\n\t\tfindText:{\n\n\t\t\tget() { return this.text; },\n\t\t\tset(v){\n\n\t\t\t\tthis.text = v;\n\t\t\t\tlet p = this.pprop;\n\n\t\t\t\tif ( !v ) this.$emit( 'input', this.items );\n\n\t\t\t\tvar txt = v.toLowerCase();\n\n\t\t\t\tif ( typeof p === 'function') {\n\n \t\t\t\t\tthis.$emit( 'input', this.items.filter(\n\t\t\t\t\t\tit=>p(it, txt )\n\t\t\t\t\t));\n\n\t\t\t\t} else this.$emit( 'input', this.items.filter(\n\t\t\t\t\tit=>(typeof it === 'object') &&\n\t\t\t\t\t( (typeof it[p]) === 'string' ) && it[p].toLowerCase().includes( txt )\n\t\t\t\t));\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n<\/script>\n\n\n<template>\n\t<div class=\"filter-box\" v-if=\"!this.minItems||text||(this.items.length>=this.minItems)\">\n\t\t<label :for=\"elmId('filter')\">Find</label>\n\t\t<input :id=\"elmId('filter')\" v-model=\"findText\" type=\"text\">\n\t</div>\n</template>\n\n\n<style scoped>\nlabel {\n\tmargin-right:var(--md-gap);\n}\n</style>"],sourceRoot:""}]);const l=a},2657:(t,e,n)=>{n.d(e,{Z:()=>l});var s=n(4015),r=n.n(s),i=n(3645),a=n.n(i)()(r());a.push([t.id,"\ntr .table-head[data-v-28e20fbc] {\n\tcursor: pointer;\n\ttext-decoration: underline;\n\tuser-select: none;\n\t-moz-user-select: none;\n\t-webkit-user-select: none;\n}\ndiv.bestiary[data-v-28e20fbc] {\ndisplay:flex;\nflex-direction: column;\nmargin-left:0.9em;\npadding:0;\nmargin:0;\n}\n.char-list[data-v-28e20fbc] {\n\twidth:100%;\n\tpadding: 0; margin: 0;\n\toverflow-y:auto;\n\tmargin-bottom:1rem;\n}\ntable.bestiary[data-v-28e20fbc] {\n\tborder-spacing: var(--sm-gap) 0;\n\tborder-collapse: collapse;\n\trow-gap: var(--sm-gap);\n\tcolumn-gap: var(--md-gap);\n}\ntr:first-child .table-head[data-v-28e20fbc] {\n\tborder-bottom: 1pt solid black;\n\tmargin:var(--sm-gap);\n}\n.table-head[data-v-28e20fbc] {\n\tpadding: var(--sm-gap) var(--md-gap);\n}\ntd.num-align[data-v-28e20fbc] {\n\tpadding: var(--md-gap);\n}\n\n","",{version:3,sources:["webpack://./src/ui/sections/bestiary.vue"],names:[],mappings:";AAwIA;CACA,eAAA;CACA,0BAAA;CACA,iBAAA;CACA,sBAAA;CACA,yBAAA;AACA;AAEA;AACA,YAAA;AACA,sBAAA;AACA,iBAAA;AACA,SAAA;AACA,QAAA;AACA;AAEA;CACA,UAAA;CACA,UAAA,EAAA,SAAA;CACA,eAAA;CACA,kBAAA;AACA;AAEA;CACA,+BAAA;CACA,yBAAA;CACA,sBAAA;CACA,yBAAA;AACA;AAEA;CACA,8BAAA;CACA,oBAAA;AACA;AAGA;CACA,oCAAA;AACA;AAEA;CACA,sBAAA;AACA",sourcesContent:['<script>\nimport Game from \'../../game\';\nimport ItemBase from \'../itemsBase\';\nimport Range from \'../../values/range\';\nimport FilterBox from \'../components/filterbox.vue\';\nimport { TRY_USE } from \'../../events\';\nimport { npcCost } from \'modules/craft\';\nimport { TYP_RANGE } from \'values/consts\';\nimport { NpcLoreLevels } from \'values/craftVars\';\n\nexport default {\n\n\tmixins:[ItemBase],\n\tdata(){\n\t\treturn {\n\t\t\tfiltered:null,\n\t\t\tsortBy:\'level\',\n\t\t\tsortOrder:1,\n\t\t\tloreLevels:{\n\t\t\t}\n\n\t\t};\n\t},\n\tcomponents:{\n\t\tfilterbox:FilterBox\n\t},\n\tbeforeCreate(){\n\t\tthis.game = Game;\n\t},\n\tmethods:{\n\n\t\ttryUse(m){\n\t\t\tthis.emit( TRY_USE, m );\n\t\t},\n\n\t\tloreLevel(m){\n\t\t\tlet lore = this.loreLevels[m.kind];\n\t\t\tif ( lore === undefined ) lore = this.$set( this.loreLevels, m.kind, NpcLoreLevels(m.kind, Game ));\n\t\t\treturn lore;\n\t\t},\n\n\t\tshowHp(m) {\n\t\t\treturn this.loreLevel(m) >= 4*m.level;\n\n\t\t},\n\n\t\ttoNum(v) {\n\t\t\treturn ( typeof v === \'object\' ?\n\t\t\t\t( v.type === TYP_RANGE ? v.max : v.value ) : v ).toFixed(0);\n\t\t},\n\n\t\tsetSort( by ) {\n\n\t\t\tif ( this.sortBy === by ) {\n\t\t\t\tthis.sortOrder = -this.sortOrder;\n\t\t\t} else this.sortBy = by;\n\n\t\t}\n\n\t},\n\tcomputed:{\n\n\t\tminions(){return Game.state.minions; },\n\n\t\tallItems(){\n\n\t\t\tlet all = Game.state.monsters;\n\t\t\tfor( let i = all.length-1; i>=0; i-- ) {\n\t\t\t\tall[i].name = all[i].name.toTitleCase()\n\t\t\t}\n\t\t\tvar a = [];\n\n\t\t\tfor( let i = all.length-1; i>=0; i-- ) {\n\n\t\t\t\tvar it = all[i];\n\t\t\t\tif ( it.value <= 0 ) continue;\n\t\t\t\tif ( !it.cost ) this.$set( it, \'cost\', npcCost(it));\n\t\t\t\ta.push(it);\n\n\t\t\t}\n\n\t\t\treturn a;\n\n\t\t},\n\n\t\tsorted(){\n\n\t\t\tlet by = this.sortBy;\n\t\t\tlet order = this.sortOrder;\n\t\t\tlet v1,v2;\n\n\t\t\treturn ( this.filtered || this.allItems ).sort(\n\t\t\t\t(a,b)=> {\n\n\t\t\t\t\tv1 = a[by];\n\t\t\t\t\tv2 = b[by];\n\t\t\t\t\tif ( v1 > v2 ) return order;\n\t\t\t\t\telse if ( v2 > v1 ) return -order;\n\t\t\t\t\telse return 0;\n\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n}\n<\/script>\n\n<template>\n\n<div class="bestiary">\n\n\t<filterbox v-model="filtered" :items="allItems" min-items="14" />\n\n\t<div class="char-list">\n\t<table class="bestiary">\n\t\t<tr>\n\t\t\t<th class="table-head" @click="setSort(\'name\')">Creature</th>\n\t\t\t<th class="table-head" @click="setSort(\'level\')">Level</th>\n\t\t\t<th class="table-head" @click="setSort(\'value\')">Slain</th>\n\t\t\t<th class="num-align table-head" @click="setSort(\'hp\')">Hp</th></tr>\n\t\t<tr v-for="b in sorted" :key="b.id" @mouseenter.capture.stop="itemOver($event,b)">\n\t\t\t<th class="lg-name">{{ b.name }}</th>\n\t\t\t<td class="num-align">{{ Math.floor( b.level ) }}</td>\n\t\t\t<td class="num-align">{{ Math.floor( b.value ) }}</td>\n\t\t\t<td class="num-align">{{ showHp(b) ? toNum(b.hp) : \'???\' }}</td>\n\t\t\t<td><button @click="tryUse(b)" :disabled="b.unique||!b.canUse(game)||minions.freeSpace()==0">Buy</button></td>\n\t\t</tr>\n\t</table>\n\t</div>\n\n</div>\n\n</template>\n\n<style scoped>\n\ntr .table-head {\n\tcursor: pointer;\n\ttext-decoration: underline;\n\tuser-select: none;\n\t-moz-user-select: none;\n\t-webkit-user-select: none;\n}\n\ndiv.bestiary {\ndisplay:flex;\nflex-direction: column;\nmargin-left:0.9em;\npadding:0;\nmargin:0;\n}\n\n.char-list {\n\twidth:100%;\n\tpadding: 0; margin: 0;\n\toverflow-y:auto;\n\tmargin-bottom:1rem;\n}\n\ntable.bestiary {\n\tborder-spacing: var(--sm-gap) 0;\n\tborder-collapse: collapse;\n\trow-gap: var(--sm-gap);\n\tcolumn-gap: var(--md-gap);\n}\n\ntr:first-child .table-head {\n\tborder-bottom: 1pt solid black;\n\tmargin:var(--sm-gap);\n}\n\n\n.table-head {\n\tpadding: var(--sm-gap) var(--md-gap);\n}\n\ntd.num-align {\n\tpadding: var(--md-gap);\n}\n\n</style>'],sourceRoot:""}]);const l=a},4194:(t,e,n)=>{n.d(e,{Z:()=>C});var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return!this.minItems||t.text||this.items.length>=this.minItems?n("div",{staticClass:"filter-box"},[n("label",{attrs:{for:t.elmId("filter")}},[t._v("Find")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.findText,expression:"findText"}],attrs:{id:t.elmId("filter"),type:"text"},domProps:{value:t.findText},on:{input:function(e){e.target.composing||(t.findText=e.target.value)}}})]):t._e()};s._withStripped=!0;const r={props:["value","items","prop","minItems"],data(){return{text:"",pprop:this.prop||"name"}},watch:{items(t,e){this.findText=this.findText}},created(){this.findText=this.text},methods:{clear(){this.text=""}},computed:{findText:{get(){return this.text},set(t){this.text=t;let e=this.pprop;t||this.$emit("input",this.items);var n=t.toLowerCase();"function"==typeof e?this.$emit("input",this.items.filter((t=>e(t,n)))):this.$emit("input",this.items.filter((t=>"object"==typeof t&&"string"==typeof t[e]&&t[e].toLowerCase().includes(n))))}}}};var i=n(3379),a=n.n(i),l=n(7795),o=n.n(l),m=n(569),d=n.n(m),A=n(3565),c=n.n(A),p=n(9216),u=n.n(p),v=n(4589),h=n.n(v),f=n(1430),b={};b.styleTagTransform=h(),b.setAttributes=c(),b.insert=d().bind(null,"head"),b.domAPI=o(),b.insertStyleElement=u(),a()(f.Z,b),f.Z&&f.Z.locals&&f.Z.locals;var g=(0,n(1900).Z)(r,s,[],!1,null,"6d0e0bec",null);g.options.__file="src/ui/components/filterbox.vue";const C=g.exports},597:(t,e,n)=>{n.r(e),n.d(e,{default:()=>T});var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bestiary"},[n("filterbox",{attrs:{items:t.allItems,"min-items":"14"},model:{value:t.filtered,callback:function(e){t.filtered=e},expression:"filtered"}}),t._v(" "),n("div",{staticClass:"char-list"},[n("table",{staticClass:"bestiary"},[n("tr",[n("th",{staticClass:"table-head",on:{click:function(e){return t.setSort("name")}}},[t._v("Creature")]),t._v(" "),n("th",{staticClass:"table-head",on:{click:function(e){return t.setSort("level")}}},[t._v("Level")]),t._v(" "),n("th",{staticClass:"table-head",on:{click:function(e){return t.setSort("value")}}},[t._v("Slain")]),t._v(" "),n("th",{staticClass:"num-align table-head",on:{click:function(e){return t.setSort("hp")}}},[t._v("Hp")])]),t._v(" "),t._l(t.sorted,(function(e){return n("tr",{key:e.id,on:{"!mouseenter":function(n){return n.stopPropagation(),t.itemOver(n,e)}}},[n("th",{staticClass:"lg-name"},[t._v(t._s(e.name))]),t._v(" "),n("td",{staticClass:"num-align"},[t._v(t._s(Math.floor(e.level)))]),t._v(" "),n("td",{staticClass:"num-align"},[t._v(t._s(Math.floor(e.value)))]),t._v(" "),n("td",{staticClass:"num-align"},[t._v(t._s(t.showHp(e)?t.toNum(e.hp):"???"))]),t._v(" "),n("td",[n("button",{attrs:{disabled:e.unique||!e.canUse(t.game)||0==t.minions.freeSpace()},on:{click:function(n){return t.tryUse(e)}}},[t._v("Buy")])])])}))],2)])],1)};s._withStripped=!0;var r=n(7112),i=n(9736),a=(n(7130),n(4194)),l=n(4478),o=n(7826),m=n(9188),d=n(2572);const A={mixins:[i.Z],data:()=>({filtered:null,sortBy:"level",sortOrder:1,loreLevels:{}}),components:{filterbox:a.Z},beforeCreate(){this.game=r.ZP},methods:{tryUse(t){this.emit(l.Nn,t)},loreLevel(t){let e=this.loreLevels[t.kind];return void 0===e&&(e=this.$set(this.loreLevels,t.kind,(0,d.B2)(t.kind,r.ZP))),e},showHp(t){return this.loreLevel(t)>=4*t.level},toNum:t=>("object"==typeof t?t.type===m.TQ?t.max:t.value:t).toFixed(0),setSort(t){this.sortBy===t?this.sortOrder=-this.sortOrder:this.sortBy=t}},computed:{minions:()=>r.ZP.state.minions,allItems(){let t=r.ZP.state.monsters;for(let e=t.length-1;e>=0;e--)t[e].name=t[e].name.toTitleCase();var e=[];for(let s=t.length-1;s>=0;s--){var n=t[s];n.value<=0||(n.cost||this.$set(n,"cost",(0,o.fr)(n)),e.push(n))}return e},sorted(){let t,e,n=this.sortBy,s=this.sortOrder;return(this.filtered||this.allItems).sort(((r,i)=>(t=r[n],e=i[n],t>e?s:e>t?-s:0)))}}};var c=n(3379),p=n.n(c),u=n(7795),v=n.n(u),h=n(569),f=n.n(h),b=n(3565),g=n.n(b),C=n(9216),y=n.n(C),x=n(4589),_=n.n(x),k=n(2657),B={};B.styleTagTransform=_(),B.setAttributes=g(),B.insert=f().bind(null,"head"),B.domAPI=v(),B.insertStyleElement=y(),p()(k.Z,B),k.Z&&k.Z.locals&&k.Z.locals;var w=(0,n(1900).Z)(A,s,[],!1,null,"28e20fbc",null);w.options.__file="src/ui/sections/bestiary.vue";const T=w.exports},7826:(t,e,n)=>{n.d(e,{fr:()=>a,e3:()=>o});var s=n(7112),r=n(2572);const i=(t,e,n)=>{if(!s.ZP.state.exists(e))return;let r=t[e];t[e]=r?r+n:n},a=t=>{let e=t.level,n={gold:100*Math.ceil(Math.pow(e,1.7))};return t.kind&&l(t.kind,n,e),t.biome&&l(t.biome,n,e),t.regen&&i(n,"bloodgem",5*(0,r.kR)(e)),n},l=(t,e={},n=1)=>{if(t){t=(0,r.Ku)(t);let s=(0,r.AQ)(t,n);i(e,s,n-(0,r.Lm)(n)+1)}else if(Array.isArray(t))for(let s=t.length-1;s>=0;s--)t[s]&&l(t[s],e,n);return e},o=t=>{var e={};for(let s=t.length-1;s>=0;s--){var n=t[s];e.gold=(e.gold||0)+300*n.level,m(n.school,n.level,e)}return e},m=(t,e=1,n={})=>{if(Array.isArray(t))for(let s=t.length-1;s>=0;s--)m(t[s],e,n);else null!=t&&(i(n,t+"gem",Math.min(e,5)*e),e<=5?i(n,"codices",e):i(n,"tomes",e=5));return n}}}]);
//# sourceMappingURL=bestiary-ui.bundle.js.map