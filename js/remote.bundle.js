"use strict";(self.webpackChunk_name_=self.webpackChunk_name_||[]).push([[797],{7094:(e,t,r)=>{r.d(t,{Z:()=>a});var s=r(3645),i=r.n(s)()((function(e){return e[1]}));i.push([e.id,"\n.popup[data-v-70f3611a] {\n\tmax-width: unset;\n\twidth: unset;\n}\n\n",""]);const a=i},5359:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"popup"},[e.err?r("div",[e._v(" "+e._s(e.err))]):e._e(),e._v(" "),e.sent?e._e():r("div",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email",placeholder:"email@email.com"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.pw,expression:"pw"}],attrs:{type:"password",placeholder:"password"},domProps:{value:e.pw},on:{input:function(t){t.target.composing||(e.pw=t.target.value)}}}),e._v(" "),r("input",{attrs:{type:"submit",value:"register"},on:{click:e.register}}),e._v(" "),r("button",{on:{click:function(t){return e.$emit("close")}}},[e._v("cancel")])])])};s._withStripped=!0;const i={data:()=>({email:null,pw:null,err:null,sent:!1}),mounted(){this.listen("register-sent",this.onRegister,this),this.listen("register-error",this.onError,this)},beforeDestroy(){this.removeListener("register-sent",this.onRegister,this),this.removeListener("register-error",this.onError,this)},methods:{register(){this.email?this.pw?(this.dispatch("try-register",this.email,this.pw),this.email=null):this.err="password required":this.err="Email required"},onRegister(){this.err="Confirmation email sent.\nCheck any junk-mail folders."},onError(e){console.dir(e),this.err=e.message}}};var a=(0,r(1900).Z)(i,s,[],!1,null,null,null);a.options.__file="src/ui/components/register.vue";const l=a.exports},7907:(e,t,r)=>{r.r(t),r.d(t,{default:()=>_});var s=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"popup",attrs:{id:"firebaseui-auth-container"}})};s._withStripped=!0;const i={props:[],data:()=>({}),beforeDestroy(){this.ui&&this.ui.delete(),this.removeListener("login",this.emitClose)},mounted(){this.listen("login",this.emitClose,this);var e={signInFlow:"popup",callbacks:{signInSuccessWithAuthResult:(e,t)=>{this.$emit("close")},signInFailure:e=>{console.log("SIGN IN ERROR: "+e)}},signInOptions:[firebase.auth.GoogleAuthProvider.PROVIDER_ID,firebase.auth.EmailAuthProvider.PROVIDER_ID,firebase.auth.PhoneAuthProvider.PROVIDER_ID,window.firebaseui.auth.AnonymousAuthProvider.PROVIDER_ID],tosUrl:"lololol",privacyPolicyUrl:"./privacy.html"};this.ui||(this.ui=new firebaseui.auth.AuthUI(firebase.auth())),this.ui.start("#firebaseui-auth-container",e)},methods:{emitClose(){this.$emit("close")}}};var a=r(3379),l=r.n(a),n=r(7795),o=r.n(n),u=r(569),h=r.n(u),d=r(3565),g=r.n(d),c=r(9216),p=r.n(c),m=r(4589),v=r.n(m),f=r(7094),w={};w.styleTagTransform=v(),w.setAttributes=g(),w.insert=h().bind(null,"head"),w.domAPI=o(),w.insertStyleElement=p(),l()(f.Z,w),f.Z&&f.Z.locals&&f.Z.locals;var I=(0,r(1900).Z)(i,s,[],!1,null,"70f3611a",null);I.options.__file="src/ui/popups/login.vue";const _=I.exports},3974:(e,t,r)=>{r.r(t),r.d(t,{Remote:()=>u});var s=r(5503),i=(r(7397),r(332),r(2961)),a=r(4478);const l=s.storage.StringFormat;window.firebase=s;const n={apiKey:"AIzaSyDa2Qj2VQvTzhG0MwzxS-IhQy9LYpCgrRM",authDomain:"theory-of-magic-49589.firebaseapp.com",databaseURL:"https://theory-of-magic-49589.firebaseio.com",projectId:"theory-of-magic-49589",storageBucket:"theory-of-magic-49589.appspot.com",messagingSenderId:"347528879664",appId:"1:347528879664:web:1ba41f1286d54923e317f5"},o={get userid(){return this.auth.currentUser.uid},get loggedIn(){return null!=this.auth.currentUser},init(){s.initializeApp(n),this.auth=s.auth(),this.auth.onAuthStateChanged((e=>{e&&console.log("AUTH: "+e.uid),a.ZP.dispatch("login-changed",null!=e)}))},logout(){return this.auth.signOut()},login(e,t){},register(e,t){},deleteHall:e=>null,loadHall(){return s.storage().ref(this.hallDir(this.userid)).getDownloadURL().then((e=>(0,i.hq)(e,!1)),(e=>{throw console.warn(e),e}))},loadChar(e){var t=s.storage().ref(this.saveDir(this.userid,e));return console.log("LOADING FIREBASE: "+e),t.getDownloadURL().then((e=>(0,i.hq)(e,!1)),(e=>(console.warn(e),null)))},deleteChar(e){return s.storage().ref(this.saveDir(this.userid,e)).delete()},saveChar(e,t){return s.storage().ref(this.saveDir(this.userid,t)).putString(e,l.RAW)},saveHall(e,t){return s.storage().ref(this.hallDir(this.userid)).putString(e,l.RAW)},hallDir:e=>"usersaves/"+e+"/hall.json",saveDir:(e,t)=>"usersaves/"+e+"/"+t+".json"};o.init();const u={lastSave:0,lastHallSave:0,logout:()=>o.logout(),loggedIn:()=>o.loggedIn,clearAll(){if(!o.loggedIn)return null},tryRegister(e,t){console.log("try register: "+e),this.remote&&this.remote.register(e,t).then((()=>{this.dispatch("register-sent")}),(e=>{console.log("dispatch reg error"),this.dispatch("register-error",e)}))},manualSave(e,t){return this.saveChar(e,t,1e4)},manualSaveHall(e,t){return this.saveHall(e,t,1e4)},saveChar(e,t,r=18e4){if(!o.loggedIn)return null;console.log("saving remote: "+t);var s=Date.now();return s-this.lastSave<r?null:(this.lastSave=s,o.saveChar(e,t))},saveHall(e,t,r=18e4){if(!o.loggedIn)return null;var s=Date.now();return s-this.lastHallSave<r?null:(this.lastHallSave=s,o.saveHall(e,t))},loadChar:e=>o.loggedIn?o.loadChar(e):null,loadHall:e=>o.loggedIn?o.loadHall(e):null}}}]);