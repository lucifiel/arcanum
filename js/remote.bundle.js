"use strict";(self.webpackChunk_name_=self.webpackChunk_name_||[]).push([[797],{7094:(e,t,i)=>{i.d(t,{Z:()=>o});var r=i(4015),s=i.n(r),n=i(3645),a=i.n(n)()(s());a.push([e.id,"\n.popup[data-v-70f3611a] {\n\tmax-width: unset;\n\twidth: unset;\n}\n\n","",{version:3,sources:["webpack://./src/ui/popups/login.vue"],names:[],mappings:";AAqEA;CACA,gBAAA;CACA,YAAA;AACA",sourcesContent:["<script>\n\nexport default {\n\n\tprops:[],\n\tdata(){\n\t\treturn {\n\n\t\t}\n\t},\n\tbeforeDestroy(){\n\t\tif ( this.ui ) this.ui.delete();\n\t\tthis.removeListener( 'login', this.emitClose );\n\t},\n\tmounted(){\n\n\t\tthis.listen('login', this.emitClose, this );\n\n      var uiConfig = {\n\t\tsignInFlow:'popup',\n\t\tcallbacks:{\n\n\t\t\tsignInSuccessWithAuthResult:(authResult, redirectUrl) => {\n\t\t\t\tthis.$emit('close');\n\t\t\t},\n\t\t\tsignInFailure:(error) => {\n\t\t\t\tconsole.log('SIGN IN ERROR: ' + error );\n\t\t\t}\n\n\t\t},\n        signInOptions: [\n          // Leave the lines as is for the providers you want to offer your users.\n         firebase.auth.GoogleAuthProvider.PROVIDER_ID,\n         //firebase.auth.FacebookAuthProvider.PROVIDER_ID,\n    \t //firebase.auth.TwitterAuthProvider.PROVIDER_ID,\n         firebase.auth.EmailAuthProvider.PROVIDER_ID,\n         firebase.auth.PhoneAuthProvider.PROVIDER_ID,\n         window.firebaseui.auth.AnonymousAuthProvider.PROVIDER_ID\n        ],\n        // tosUrl and privacyPolicyUrl accept either url string or a callback\n        // function.\n        // Terms of service url/callback.\n        tosUrl: 'lololol',\n        // Privacy policy url/callback.\n        privacyPolicyUrl:'./privacy.html'\n\n      };\n\n    \t// Initialize the FirebaseUI Widget using Firebase.\n\t\tif (!this.ui ) this.ui = new firebaseui.auth.AuthUI(firebase.auth());\n\n    \t// The start method will wait until the DOM is loaded.\n\t\tthis.ui.start('#firebaseui-auth-container', uiConfig);\n\n\t},\n\tmethods:{\n\t\temitClose(){this.$emit('close')}\n\t}\n\n}\n<\/script>\n\n<template>\n\t<div class=\"popup\" id=\"firebaseui-auth-container\">\n\t</div>\n</template>\n\n<style scoped>\n\n.popup {\n\tmax-width: unset;\n\twidth: unset;\n}\n\n</style>"],sourceRoot:""}]);const o=a},5359:(e,t,i)=>{i.r(t),i.d(t,{default:()=>a});var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"popup"},[e.err?i("div",[e._v(" "+e._s(e.err))]):e._e(),e._v(" "),e.sent?e._e():i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email",placeholder:"email@email.com"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.pw,expression:"pw"}],attrs:{type:"password",placeholder:"password"},domProps:{value:e.pw},on:{input:function(t){t.target.composing||(e.pw=t.target.value)}}}),e._v(" "),i("input",{attrs:{type:"submit",value:"register"},on:{click:e.register}}),e._v(" "),i("button",{on:{click:function(t){return e.$emit("close")}}},[e._v("cancel")])])])};r._withStripped=!0;const s={data:()=>({email:null,pw:null,err:null,sent:!1}),mounted(){this.listen("register-sent",this.onRegister,this),this.listen("register-error",this.onError,this)},beforeDestroy(){this.removeListener("register-sent",this.onRegister,this),this.removeListener("register-error",this.onError,this)},methods:{register(){this.email?this.pw?(this.dispatch("try-register",this.email,this.pw),this.email=null):this.err="password required":this.err="Email required"},onRegister(){this.err="Confirmation email sent.\nCheck any junk-mail folders."},onError(e){console.dir(e),this.err=e.message}}};var n=(0,i(1900).Z)(s,r,[],!1,null,null,null);n.options.__file="src/ui/components/register.vue";const a=n.exports},7907:(e,t,i)=>{i.r(t),i.d(t,{default:()=>A});var r=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"popup",attrs:{id:"firebaseui-auth-container"}})};r._withStripped=!0;const s={props:[],data:()=>({}),beforeDestroy(){this.ui&&this.ui.delete(),this.removeListener("login",this.emitClose)},mounted(){this.listen("login",this.emitClose,this);var e={signInFlow:"popup",callbacks:{signInSuccessWithAuthResult:(e,t)=>{this.$emit("close")},signInFailure:e=>{console.log("SIGN IN ERROR: "+e)}},signInOptions:[firebase.auth.GoogleAuthProvider.PROVIDER_ID,firebase.auth.EmailAuthProvider.PROVIDER_ID,firebase.auth.PhoneAuthProvider.PROVIDER_ID,window.firebaseui.auth.AnonymousAuthProvider.PROVIDER_ID],tosUrl:"lololol",privacyPolicyUrl:"./privacy.html"};this.ui||(this.ui=new firebaseui.auth.AuthUI(firebase.auth())),this.ui.start("#firebaseui-auth-container",e)},methods:{emitClose(){this.$emit("close")}}};var n=i(3379),a=i.n(n),o=i(7795),l=i.n(o),u=i(569),h=i.n(u),c=i(3565),d=i.n(c),p=i(9216),g=i.n(p),m=i(4589),v=i.n(m),f=i(7094),I={};I.styleTagTransform=v(),I.setAttributes=d(),I.insert=h().bind(null,"head"),I.domAPI=l(),I.insertStyleElement=g(),a()(f.Z,I),f.Z&&f.Z.locals&&f.Z.locals;var w=(0,i(1900).Z)(s,r,[],!1,null,"70f3611a",null);w.options.__file="src/ui/popups/login.vue";const A=w.exports},3974:(e,t,i)=>{i.r(t),i.d(t,{Remote:()=>u});var r=i(5503),s=(i(7397),i(332),i(2961)),n=i(4478);const a=r.storage.StringFormat;window.firebase=r;const o={apiKey:"AIzaSyDa2Qj2VQvTzhG0MwzxS-IhQy9LYpCgrRM",authDomain:"theory-of-magic-49589.firebaseapp.com",databaseURL:"https://theory-of-magic-49589.firebaseio.com",projectId:"theory-of-magic-49589",storageBucket:"theory-of-magic-49589.appspot.com",messagingSenderId:"347528879664",appId:"1:347528879664:web:1ba41f1286d54923e317f5"},l={get userid(){return this.auth.currentUser.uid},get loggedIn(){return null!=this.auth.currentUser},init(){r.initializeApp(o),this.auth=r.auth(),this.auth.onAuthStateChanged((e=>{e&&console.log("AUTH: "+e.uid),n.ZP.dispatch("login-changed",null!=e)}))},logout(){return this.auth.signOut()},login(e,t){},register(e,t){},deleteHall:e=>null,loadHall(){return r.storage().ref(this.hallDir(this.userid)).getDownloadURL().then((e=>(0,s.hq)(e,!1)),(e=>{throw console.warn(e),e}))},loadChar(e){var t=r.storage().ref(this.saveDir(this.userid,e));return console.log("LOADING FIREBASE: "+e),t.getDownloadURL().then((e=>(0,s.hq)(e,!1)),(e=>(console.warn(e),null)))},deleteChar(e){return r.storage().ref(this.saveDir(this.userid,e)).delete()},saveChar(e,t){return r.storage().ref(this.saveDir(this.userid,t)).putString(e,a.RAW)},saveHall(e,t){return r.storage().ref(this.hallDir(this.userid)).putString(e,a.RAW)},hallDir:e=>"usersaves/"+e+"/hall.json",saveDir:(e,t)=>"usersaves/"+e+"/"+t+".json"};l.init();const u={lastSave:0,lastHallSave:0,logout:()=>l.logout(),loggedIn:()=>l.loggedIn,clearAll(){if(!l.loggedIn)return null},tryRegister(e,t){console.log("try register: "+e),this.remote&&this.remote.register(e,t).then((()=>{this.dispatch("register-sent")}),(e=>{console.log("dispatch reg error"),this.dispatch("register-error",e)}))},manualSave(e,t){return this.saveChar(e,t,1e4)},manualSaveHall(e,t){return this.saveHall(e,t,1e4)},saveChar(e,t,i=18e4){if(!l.loggedIn)return null;console.log("saving remote: "+t);var r=Date.now();return r-this.lastSave<i?null:(this.lastSave=r,l.saveChar(e,t))},saveHall(e,t,i=18e4){if(!l.loggedIn)return null;var r=Date.now();return r-this.lastHallSave<i?null:(this.lastHallSave=r,l.saveHall(e,t))},loadChar:e=>l.loggedIn?l.loadChar(e):null,loadHall:e=>l.loggedIn?l.loadHall(e):null}}}]);
//# sourceMappingURL=remote.bundle.js.map