"use strict";(self.webpackChunk_name_=self.webpackChunk_name_||[]).push([[811],{3093:(t,n,e)=>{e.d(n,{Z:()=>c});var i=e(4015),s=e.n(i),a=e(3645),o=e.n(a)()(s());o.push([t.id,"\ndiv.activities[data-v-cacde55a] {\n\tmin-width: 28rem;\n\twidth: fit-content;\n\tpadding-top:1em;\n\tpadding: 1.5em;\n}\ndiv.section[data-v-cacde55a] {\n\tmargin-top: 1em;\n\tmin-width: 100%;\n}\ndiv.task-info[data-v-cacde55a] {\n\tdisplay:flex;\n\twidth: 90%;\n\tmargin: var(--sm-gap) 0;\n}\nbutton.stop[data-v-cacde55a] {\n\tmargin: 0 var(--sm-gap);\n}\nspan.task-name[data-v-cacde55a] {\n\tflex-grow:1;\n\tvertical-align: center;\n}\ndiv.section header[data-v-cacde55a] {\n\tborder-bottom: 1px solid var(--separator-color);\n\tmargin-bottom: var(--sm-gap);\n}\n\n","",{version:3,sources:["webpack://./src/ui/popups/activities.vue"],names:[],mappings:";AA8JA;CACA,gBAAA;CACA,kBAAA;CACA,eAAA;CACA,cAAA;AACA;AAEA;CACA,eAAA;CACA,eAAA;AACA;AAEA;CACA,YAAA;CACA,UAAA;CACA,uBAAA;AACA;AAEA;CACA,uBAAA;AACA;AAEA;CACA,WAAA;CACA,sBAAA;AACA;AAEA;CACA,+CAAA;CACA,4BAAA;AACA",sourcesContent:['<script>\nimport Game from \'game\';\nimport { centerXY, positionAt } from \'./popups.js\';\n\n/**\n * Popup Activities Manager.\n */\nexport default {\n\n\tmixins:[],\n\tdata(){\n\n\t\treturn {\n\t\t\t/**\n\t\t\t * force refresh when array keys swapped.\n\t\t\t */\n\t\t\tactiveKey:0,\n\t\t\twaitKey:0\n\t\t};\n\n\t},\n\tmounted() {\n\n\t\tif ( this.elm) positionAt( this.$el, this.elm, 0 );\n\t\telse centerXY( this.$el, 0.2 );\n\n\t},\n\tcomputed:{\n\n\t\trunner(){\n\t\t\treturn Game.runner;\n\t\t},\n\n\t\tactives(){\n\t\t\treturn this.runner.actives;\n\t\t},\n\n\t\tactivesLen(){return this.actives.size;},\n\n\t\twaiting(){\n\t\t\treturn this.runner.waiting.reverse();\n\t\t},\n\t\t/**\n\t\t * reversed clone of pursuit items.\n\t\t * @property {DataList>Inventory}\n\t\t */\n\t\tpursuits(){\n\t\t\treturn this.runner.pursuits;\n\t\t}\n\n\t},\n\tmethods:{\n\n\t\tincActive(t){\n\t\t\tthis.actives.inc(t);\n\t\t\tthis.activeKey++;\n\t\t},\n\n\t\tdecActive(t){\n\t\t\tthis.actives.dec(t);\n\t\t\tthis.activeKey++;\n\t\t},\n\n\t\tremoveActive(t){\n\t\t\tthis.runner.stopTask(t);\n\t\t},\n\n\t\tremoveWait(t){\n\t\t\tthis.runner.removeWait(t);\n\t\t},\n\n\t\t/**\n\t\t * Increase priority.\n\t\t */\n\t\tincWaiting(t){\n\t\t\tthis.runner.waitingUp(t);\n\t\t},\n\n\t\t/**\n\t\t * Decrease priority.\n\t\t */\n\t\tdecWaiting(t){\n\t\t\tthis.runner.waitingDown(t);\n\t\t},\n\n\t\tremovePursuit(t){\n\t\t\tthis.pursuits.remove(t);\n\t\t},\n\n\t\t/**\n\t\t * Increase priority.\n\t\t */\n\t\tincPursuits(t){\n\t\t\tthis.runner.pursuitUp(t);\n\t\t},\n\n\t\t/**\n\t\t * Decrease priority.\n\t\t */\n\t\tdecPursuits(t){\n\t\t\tthis.runner.pursuitDown(t);\n\t\t}\n\n\t}\n\n}\n<\/script>\n\n<template>\n<div class="popup activities">\n\n\t<div class="popup-close" @click="$emit(\'close\')">X</div>\n\n\t<div class="section" :key="\'k\'+activeKey">\n\t\t<header>Activities</header>\n\t\t<div v-if="activesLen===0" class="note-text">None</div>\n\t\t<div v-else>\n\t\t<div v-for="(t,ind) in actives.values().reverse()" :key="\'a\'+ind" class="task-info">\n\t\t\t<button class="stop" @click="removeActive(t)">X</button><span class="task-name">{{ t.name.toTitleCase() }}</span>\n\t\t\t\x3c!-- note: indices are reversed --\x3e\n\t\t\t<button @click="incActive(t)" :disabled="ind===0">+</button>\n\t\t\t<button @click="decActive(t)" :disabled="(ind+1)===activesLen">-</button>\n\n\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="section" :key="\'w\'+waitKey">\n\t\t<header>Waiting/Blocked</header>\n\t\t<div v-if="waiting.length===0" class="note-text">None</div>\n\t\t<div v-else>\n\t\t<div v-for="(t,ind) in waiting" :key="\'w\'+ind" class="task-info">\n\t\t\t<button class="stop" @click="removeWait(t)">X</button><span class="task-name">{{ t.name.toTitleCase() }}</span>\n\t\t\t<button @click="incWaiting(t)" :disabled="ind===0">+</button>\n\t\t\t<button @click="decWaiting(t)" :disabled="(ind+1)===waiting.length">-</button>\n\n\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="section">\n\t\t<header>Pursuits</header>\n\t\t<div v-if="pursuits.count===0" class="note-text">None</div>\n\t\t<div v-else>\n\t\t<div v-for="(t) in pursuits.items" :key="t.id" class="task-info">\n\n\t\t\t<button class="stop" @click="removePursuit(t)">X</button><span class="task-name">{{ t.name.toTitleCase() }}</span>\n\t\t\t\x3c!--<button v-if="runner.canPursuit(t)" :class="[\'pursuit\', pursuits.includes( runner.baseTask(t) ) ? \'current\' : \'\']"\n\t\t\t\t\t@click="runner.togglePursuit(t)"> F </button>--\x3e\n\t\t</div>\n\t\t</div>\n\t</div>\n\n</div>\n</template>\n\n<style scoped>\n\ndiv.activities {\n\tmin-width: 28rem;\n\twidth: fit-content;\n\tpadding-top:1em;\n\tpadding: 1.5em;\n}\n\ndiv.section {\n\tmargin-top: 1em;\n\tmin-width: 100%;\n}\n\ndiv.task-info {\n\tdisplay:flex;\n\twidth: 90%;\n\tmargin: var(--sm-gap) 0;\n}\n\nbutton.stop {\n\tmargin: 0 var(--sm-gap);\n}\n\nspan.task-name {\n\tflex-grow:1;\n\tvertical-align: center;\n}\n\ndiv.section header {\n\tborder-bottom: 1px solid var(--separator-color);\n\tmargin-bottom: var(--sm-gap);\n}\n\n</style>'],sourceRoot:""}]);const c=o},7350:(t,n,e)=>{e.d(n,{Z:()=>c});var i=e(4015),s=e.n(i),a=e(3645),o=e.n(a)()(s());o.push([t.id,"\n.disabled[data-v-980be7f2] {\n  border-color: rgba(0,0,0,0.4);\n  color: rgba(0,0,0,0.4);\n}\n.popup[data-v-980be7f2] {\n\tz-index: var(--md-depth);\n\tmax-width: 50vw;\n}\n.content[data-v-980be7f2] {\n\tdisplay:flex;\n\tflex-flow: column nowrap;\n\twidth: 100%;\n\tmin-height:5rem;\n}\n.content .items[data-v-980be7f2] {\n\tdisplay:flex;\n\tflex-flow: row wrap;\n\tflex-grow: 1;\n\twidth:auto;\n}\n.content .title[data-v-980be7f2] {\n\tfont-weight: bold;\n\ttext-align: center;\n\tmargin-bottom: var(--sm-gap);\n}\n.task-btn[data-v-980be7f2] {\n\n\tmax-height: 2em;\n\twidth:100%;\n}\nbutton.close-btn[data-v-980be7f2] {\n\tmin-height: 2em;\n\twidth: 5em;\n\tfont-size:0.9em;\n}\n\n\n","",{version:3,sources:["webpack://./src/ui/popups/choice.vue"],names:[],mappings:";AAgLA;EACA,6BAAA;EACA,sBAAA;AACA;AAEA;CACA,wBAAA;CACA,eAAA;AACA;AACA;CACA,YAAA;CACA,wBAAA;CACA,WAAA;CACA,eAAA;AACA;AAEA;CACA,YAAA;CACA,mBAAA;CACA,YAAA;CACA,UAAA;AACA;AAEA;CACA,iBAAA;CACA,kBAAA;CACA,4BAAA;AACA;AAEA;;CAEA,eAAA;CACA,UAAA;AACA;AAEA;CACA,eAAA;CACA,UAAA;CACA,eAAA;AACA",sourcesContent:['<script>\nimport Game from \'../../game\';\nimport { centerX, positionAt } from \'./popups.js\';\n\nimport ItemsBase from \'../itemsBase.js\';\nimport GData from \'../../items/gdata\';\n\n/**\n * @note The Choice Mechanism is highly convoluted right now, due to Vue interactions\n * and poor structure on my part. slotpick button emits an event to open the choice popup.\n * It might be better to place choice as a component of slotpick?\n * @emits choice\n */\nexport default {\n\n\tdata() {\n\t\treturn {\n\t\t\ttitle:null,\n\t\t\tlist:null,\n\t\t\telm:null,\n\t\t\titem:null,\n\t\t\topen:false,\n\t\t\tmustPay:false,\n\t\t\tstrings:false\n\t\t}\n\t},\n\tmixins:[ItemsBase],\n\tcreated(){\n\n\t\tthis.cb = null;\n\n\t\tthis.plisten = ()=>{\n\n\t\t\t/**\n\t\t\t * Special event to show choice dialog.\n\t\t\t*/\n\t\t\tthis.add( \'choice\', this.show, this );\n\n\t\t};\n\n\t\tthis.listen(\'game-loaded\', this.plisten );\n\n\t},\n\tbeforeDestroy(){\n\t\tthis.removeListener( \'game-loaded\', this.plisten );\n\t\tthis.plisten = null;\n\t\tthis.cancel();\n\t},\n\tupdated() {\n\n\t\tif (this.open===false) return;\n\n\t\tif ( this.elm) positionAt( this.$el, this.elm, 0 );\n\t\telse centerX( this.$el );\n\n\t},\n\tcomputed:{\n\n\t\t/**\n\t\t * @property {gdata[]} choices - used to convert strings or tag string into choice objects.\n\t\t */\n\t\tchoices:{\n\n\t\t\tget(){ return this.list; },\n\t\t\tset(v){\n\n\t\t\t\tif ( typeof v === \'string\') v = Game.state.getData( v );\n\n\t\t\t\tif ( v && v.items ) v = v.items;\n\t\t\t\tif ( Array.isArray(v ) ) {\n\n\t\t\t\t\tif ( this.strings ) this.list = v;\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar a = [];\n\t\t\t\t\t\tfor( let i = v.length-1; i>= 0; i-- ) {\n\n\t\t\t\t\t\t\tvar it = Game.state.findData( v[i] );\n\t\t\t\t\t\t\tif ( it ) a.push(it);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.list = a;\n\t\t\t\t\t}\n\n\t\t\t\t} else this.list = null;\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\tmethods:{\n\n\t\t/**\n\t\t * @param {object} opts - dispaly options\n\t\t * @param {?HTMLElement} opts.elm - element to display relative to.\n\t\t * @param {?function} opts.cb - callback\n\t\t * @param {?string} opts.title - choice title.\n\t\t * @param {?boolean} opts.mustPay - must pay to select.\n\t\t * @param {?boolean} opts.strings - choices given as raw strings.\n\t\t */\n\t\tshow( choices, opts ) {\n\n\t\t\t//console.log(\'showing choices\');\n\t\t\tthis.title = opts.title;\n\t\t\tthis.cb = opts.cb;\n\t\t\tthis.elm = opts.elm;\n\t\t\tthis.strings = opts.strings;\n\t\t\tthis.mustPay = opts.mustPay;\n\n\t\t\tthis.choices = choices;\n\t\t\tthis.open=true;\n\n\t\t},\n\n\t\tcantPay(it) {\n\t\t\treturn it.cost&&!Game.canPay(it.cost);\n\t\t},\n\n    disabled(it) {\n      return !this.strings&&!this.slottable(it)||(this.mustPay&&this.cantPay(it));\n    },\n\n\t\tchoose( opt ){\n      if(this.disabled(opt)) return;\n\n\t\t\tthis.open = false;\n\t\t\tthis.item = null;\n\t\t\tthis.choices = null;\n\t\t\tthis.elm = null;\n\n\t\t\tif ( this.cb ) {\n\n\t\t\t\tlet cb = this.cb;\n\t\t\t\tthis.cb = null;\n\t\t\t\tcb( opt );\n\n\t\t\t}\n\n\t\t},\n\t\tcancel(){\n\t\t\tthis.open=false;\n\t\t\tthis.cb = null;\n\t\t\tthis.item = null;\n\t\t\tthis.choices = null;\n\t\t\tthis.elm = null;\n\t\t}\n\n\t}\n\n}\n<\/script>\n\n<template>\n<div class="popup" v-if="choices!=null&&choices.length>0">\n\t<div class="content">\n\n\t\t<span class="title" v-if="title">{{title}}</span>\n\n\t\t<div class="items">\n      \x3c!--\t\t\t:disabled="!strings&&!slottable(it)||(mustPay&&cantPay(it))"--\x3e\n\t\t<button class="task-btn"\n      :class="disabled(it) && \'disabled\'"\n\t\t\tv-for="it in choices" :key="strings?it:it.id"\n\t\t\t@mouseenter.capture.stop="!strings ? itemOver( $event,it):\'\'"\n\t\t\t@click="choose( it )">{{ strings ? it : it.name }}</button>\n\t\t</div>\n\n\t\t<button class="close-btn" @click="cancel">Cancel</button>\n\n\t</div>\n</div>\n\n</template>\n\n<style scoped>\n\n.disabled {\n  border-color: rgba(0,0,0,0.4);\n  color: rgba(0,0,0,0.4);\n}\n\n.popup {\n\tz-index: var(--md-depth);\n\tmax-width: 50vw;\n}\n.content {\n\tdisplay:flex;\n\tflex-flow: column nowrap;\n\twidth: 100%;\n\tmin-height:5rem;\n}\n\n.content .items {\n\tdisplay:flex;\n\tflex-flow: row wrap;\n\tflex-grow: 1;\n\twidth:auto;\n}\n\n.content .title {\n\tfont-weight: bold;\n\ttext-align: center;\n\tmargin-bottom: var(--sm-gap);\n}\n\n.task-btn {\n\n\tmax-height: 2em;\n\twidth:100%;\n}\n\nbutton.close-btn {\n\tmin-height: 2em;\n\twidth: 5em;\n\tfont-size:0.9em;\n}\n\n\n</style>'],sourceRoot:""}]);const c=o},1861:(t,n,e)=>{e.r(n),e.d(n,{default:()=>y});var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"popup activities"},[e("div",{staticClass:"popup-close",on:{click:function(n){return t.$emit("close")}}},[t._v("X")]),t._v(" "),e("div",{key:"k"+t.activeKey,staticClass:"section"},[e("header",[t._v("Activities")]),t._v(" "),0===t.activesLen?e("div",{staticClass:"note-text"},[t._v("None")]):e("div",t._l(t.actives.values().reverse(),(function(n,i){return e("div",{key:"a"+i,staticClass:"task-info"},[e("button",{staticClass:"stop",on:{click:function(e){return t.removeActive(n)}}},[t._v("X")]),e("span",{staticClass:"task-name"},[t._v(t._s(n.name.toTitleCase()))]),t._v(" "),e("button",{attrs:{disabled:0===i},on:{click:function(e){return t.incActive(n)}}},[t._v("+")]),t._v(" "),e("button",{attrs:{disabled:i+1===t.activesLen},on:{click:function(e){return t.decActive(n)}}},[t._v("-")])])})),0)]),t._v(" "),e("div",{key:"w"+t.waitKey,staticClass:"section"},[e("header",[t._v("Waiting/Blocked")]),t._v(" "),0===t.waiting.length?e("div",{staticClass:"note-text"},[t._v("None")]):e("div",t._l(t.waiting,(function(n,i){return e("div",{key:"w"+i,staticClass:"task-info"},[e("button",{staticClass:"stop",on:{click:function(e){return t.removeWait(n)}}},[t._v("X")]),e("span",{staticClass:"task-name"},[t._v(t._s(n.name.toTitleCase()))]),t._v(" "),e("button",{attrs:{disabled:0===i},on:{click:function(e){return t.incWaiting(n)}}},[t._v("+")]),t._v(" "),e("button",{attrs:{disabled:i+1===t.waiting.length},on:{click:function(e){return t.decWaiting(n)}}},[t._v("-")])])})),0)]),t._v(" "),e("div",{staticClass:"section"},[e("header",[t._v("Pursuits")]),t._v(" "),0===t.pursuits.count?e("div",{staticClass:"note-text"},[t._v("None")]):e("div",t._l(t.pursuits.items,(function(n){return e("div",{key:n.id,staticClass:"task-info"},[e("button",{staticClass:"stop",on:{click:function(e){return t.removePursuit(n)}}},[t._v("X")]),e("span",{staticClass:"task-name"},[t._v(t._s(n.name.toTitleCase()))])])})),0)])])};i._withStripped=!0;var s=e(7112),a=e(1825);const o={mixins:[],data:()=>({activeKey:0,waitKey:0}),mounted(){this.elm?(0,a.M)(this.$el,this.elm,0):(0,a.HF)(this.$el,.2)},computed:{runner:()=>s.ZP.runner,actives(){return this.runner.actives},activesLen(){return this.actives.size},waiting(){return this.runner.waiting.reverse()},pursuits(){return this.runner.pursuits}},methods:{incActive(t){this.actives.inc(t),this.activeKey++},decActive(t){this.actives.dec(t),this.activeKey++},removeActive(t){this.runner.stopTask(t)},removeWait(t){this.runner.removeWait(t)},incWaiting(t){this.runner.waitingUp(t)},decWaiting(t){this.runner.waitingDown(t)},removePursuit(t){this.pursuits.remove(t)},incPursuits(t){this.runner.pursuitUp(t)},decPursuits(t){this.runner.pursuitDown(t)}}};var c=e(3379),r=e.n(c),l=e(7795),u=e.n(l),A=e(569),d=e.n(A),v=e(3565),h=e.n(v),p=e(9216),m=e.n(p),g=e(4589),b=e.n(g),f=e(3093),C={};C.styleTagTransform=b(),C.setAttributes=h(),C.insert=d().bind(null,"head"),C.domAPI=u(),C.insertStyleElement=m(),r()(f.Z,C),f.Z&&f.Z.locals&&f.Z.locals;var w=(0,e(1900).Z)(o,i,[],!1,null,"cacde55a",null);w.options.__file="src/ui/popups/activities.vue";const y=w.exports},5181:(t,n,e)=>{e.r(n),e.d(n,{default:()=>k});var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return null!=t.choices&&t.choices.length>0?e("div",{staticClass:"popup"},[e("div",{staticClass:"content"},[t.title?e("span",{staticClass:"title"},[t._v(t._s(t.title))]):t._e(),t._v(" "),e("div",{staticClass:"items"},t._l(t.choices,(function(n){return e("button",{key:t.strings?n:n.id,staticClass:"task-btn",class:t.disabled(n)&&"disabled",on:{"!mouseenter":function(e){e.stopPropagation(),!t.strings&&t.itemOver(e,n)},click:function(e){return t.choose(n)}}},[t._v(t._s(t.strings?n:n.name))])})),0),t._v(" "),e("button",{staticClass:"close-btn",on:{click:t.cancel}},[t._v("Cancel")])])]):t._e()};i._withStripped=!0;var s=e(7112),a=e(1825),o=e(9736);e(4028);const c={data:()=>({title:null,list:null,elm:null,item:null,open:!1,mustPay:!1,strings:!1}),mixins:[o.Z],created(){this.cb=null,this.plisten=()=>{this.add("choice",this.show,this)},this.listen("game-loaded",this.plisten)},beforeDestroy(){this.removeListener("game-loaded",this.plisten),this.plisten=null,this.cancel()},updated(){!1!==this.open&&(this.elm?(0,a.M)(this.$el,this.elm,0):(0,a.iL)(this.$el))},computed:{choices:{get(){return this.list},set(t){if("string"==typeof t&&(t=s.ZP.state.getData(t)),t&&t.items&&(t=t.items),Array.isArray(t))if(this.strings)this.list=t;else{var n=[];for(let i=t.length-1;i>=0;i--){var e=s.ZP.state.findData(t[i]);e&&n.push(e)}this.list=n}else this.list=null}}},methods:{show(t,n){this.title=n.title,this.cb=n.cb,this.elm=n.elm,this.strings=n.strings,this.mustPay=n.mustPay,this.choices=t,this.open=!0},cantPay:t=>t.cost&&!s.ZP.canPay(t.cost),disabled(t){return!this.strings&&!this.slottable(t)||this.mustPay&&this.cantPay(t)},choose(t){if(!this.disabled(t)&&(this.open=!1,this.item=null,this.choices=null,this.elm=null,this.cb)){let n=this.cb;this.cb=null,n(t)}},cancel(){this.open=!1,this.cb=null,this.item=null,this.choices=null,this.elm=null}}};var r=e(3379),l=e.n(r),u=e(7795),A=e.n(u),d=e(569),v=e.n(d),h=e(3565),p=e.n(h),m=e(9216),g=e.n(m),b=e(4589),f=e.n(b),C=e(7350),w={};w.styleTagTransform=f(),w.setAttributes=p(),w.insert=v().bind(null,"head"),w.domAPI=A(),w.insertStyleElement=g(),l()(C.Z,w),C.Z&&C.Z.locals&&C.Z.locals;var y=(0,e(1900).Z)(c,i,[],!1,null,"980be7f2",null);y.options.__file="src/ui/popups/choice.vue";const k=y.exports}}]);
//# sourceMappingURL=popups-ui.bundle.js.map